{
    "contents" : "#data=read.csv(\"followers_reduced.csv\")\ndata=read.csv(\"followers_reduced_postSR.csv\")\nattach(data)\nDance=factor(Dance)\nSteel=factor(Steel)\nBigSD=factor(BigSD)\n\n\n#Logistic regression\n\nexit.glm=glm(exitORswitch01~Steel*BigSD,family=binomial,data=data)\nsummary(exit.glm)\n\n#Recall that runs are nested within a particular bee (and Dance is nested within bee) - so run this as nested \nexit2.glm=glm(exitORswitch01~runs,family=binomial,data=data)\nsummary(exit2.glm)\n\n# more options for glm\n# Logistic Regression\n# where F is a binary factor and\n# x1-x3 are continuous predictors\nfit <- glm(F~x1+x2+x3,data=mydata,family=binomial())\nsummary(fit) # display results\nconfint(fit) # 95% CI for the coefficients\nexp(coef(fit)) # exponentiated coefficients\nexp(confint(fit)) # 95% CI for exponentiated coefficients\npredict(fit, type=\"response\") # predicted values\nresiduals(fit, type=\"deviance\") # residuals \n#glm(formula, family=familytype(link=linkfunction), data=)\n#Family   Default Link Function\n#binomial \t(link = \"logit\")\n#gaussian \t(link = \"identity\") \n\n# GLM (not all numbers agree with SPSS output - why??)\nruns.glm=glm(runsfollowed~Steel*BigSD,family=gaussian,data=data)\nsummary(runs.glm)\n\nrunsf.glm=glm(runsfollowed~Steel*BigSD,family=gaussian,data=data)\nsummary(runsf.glm)\n\n##MIXED MODEL (Dance=random and Steel,BigSD=fixed) also from Melissa\nlibrary(nlme)\ntest=lme(runsfollowed~Steel*BigSD,random=~1|Dance,data=data)\nsummary(test)\n\ntest=lme(runs~Steel*BigSD,random=~1|Dance,data=data)\nsummary(test)\n\ninstall.packages(\"mlogit\")    \nlibrary(mlogit)    \nnested.logit <- mlogit(y~ Steel*BigSD , data,\n                       shape='long', alt.var='Dance', nests=list(Dance))\n\n\nnested.logit <- mlogit(exitORswitch~ Steel + BigSD + postSR , data,\n                      alt.var='Dance', nests=list(Dance))\n\n\n##NESTED MODEL?? (from Melissa)\n#nested=Steel:Dance  <-Melissa coded this way\nnested=Dance:Steel\nnewdata=cbind(data,nested)\n#nested2=BigSD:Dance\nnested2=Dance:BigSD\nnewdata2=cbind(newdata,nested2)\nnested3=Dance:runs\nnewdata3=cbind(newdata2,nested3)\n\n#Need to install the lme4 package\nlibrary(lme4)\nfm3= lmer(runsfollowed ~ 1 + (1 | Steel) + (1 | nested), newdata, REML=FALSE)\nfm4= lmer(runsfollowed ~ 1 + (1 | Steel), newdata, REML=FALSE)\nfm1= lmer(runs ~ 1 +  Steel*BigSD + (1 | nested) + (1 | nested2), newdata2, REML=FALSE)\nfm1.2= lmer(runs ~ (1 | Dance:Steel)*(1 | Dance:BigSD), data, REML=FALSE)\nfm2= lmer(runsfollowed ~ 1 +  Steel*BigSD + (1 | nested) + (1 | nested2), newdata2, REML=FALSE)\n\nruns2.lmer <- glmer(runs ~ Steel + (1 | Steel/Bee/Dance),family=\"poisson\")\nsummary(runs2.lmer)\n\nanova(fm4,fm3)\nsummary(fm1)\nsummary(fm2)\n\nfm5= lmer(runsfollowed ~ 1 + (1 | BigSD) + (1 | nested2), newdata2, REML=FALSE)\nfm6= lmer(runsfollowed ~ 1 + (1 | BigSD), newdata2, REML=FALSE)\nanova(fm5,fm6)\n\nfm7= glmer(exitORswitch01 ~ 1 + Steel*BigSD + (1 | nested) + (1 | nested2), newdata2, family=\"binomial\")\nfm7.2= glmer(exitORswitch01 ~ 1 + (1 | BigSD)*(1|Steel) + (1 | nested) + (1 | nested2), newdata2, family=\"binomial\")\nfm8= glmer(exitORswitch01 ~ 1 + Steel*BigSD, newdata2, family=\"binomial\")\nanova(fm7,fm8)\n\n# Nested Poisson regression for runs; EU is dancer\nruns1.glm=glm(runs~Steel,family=poisson(),data=data)\nsummary(runs1.glm)\n\nruns2.glm=glm(runs~BigSD + Steel,family=poisson(),data=data)\nsummary(runs2.glm)\n\nrunsnested1.glm=glm(runs~Steel + Error(Steel/Bee/Dance),family=poisson(),data=data)\nsummary(runsnested1.glm)\n\nruns2.lmer <- glmer(runs ~ Steel + (1 | Steel/Bee/Dance),family=\"poisson\")\nsummary(runs2.lmer)\n\n# Nested Poisson regresion for runsfollowed; EU is follower\nrunsfollowed2.glm=glm(runs~BigSD + Steel,family=poisson(),data=data)\nsummary(runsfollowed2.glm)\n\nrunsfollowednested2.glm=glm(runs~BigSD + Steel + Error(Steel/Bee/Dance),family=poisson(),data=data)\nsummary(runsfollowednested2.glm)\n\n# Nested logistic regression for exirORswitch; EU is follower\n\n",
    "created" : 1435091812326.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1217599046",
    "id" : "23FF7428",
    "lastKnownWriteTime" : 1436840727,
    "path" : "~/Google Drive/Consulting Center/Client Records/Barrett Klein/Corrected data/R Code for Mixed Model.R",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}